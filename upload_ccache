#!/bin/bash

cd /tmp

up () {
  if [ -e $1 ]; then
  echo "uploading $1"
	curl --upload-file $1 https://temp.sh/$(basename $1); echo
	# 14 days, 10 GB limit
  fi
}

echo "|| Compressing CCACHE ||"
7za a -tzip -v2048m -mx=1 ccache_backup.zip /tmp/ccache/*

# upload all parts
echo "|| Uploading CCACHE ||"
for i in /tmp/ccache_backup.zip.*; do
   up ${i}
done

# clean storage
rm -rf /tmp/*
